# Служба __Support__
# Описание
__Служба поддержки, отвечающая на обращения пользователей.__
## Функционал

* Пользователи могут писать **обращения**
* Поддержка может отвечать на **обращения**
* Пользователи могут отвечать на **сообщения** поддержки
* Поддержка может отвечать на **сообщения** пользователей
* Статус **обращения** можно изменять
* Пользователи могут регистрироваться и авторизовываться (логиниться)

## Роли

1) Неавторизованный пользователь
2) Пользователь (client)
3) Поддержка (support)
4) Администратор (admin)

## Права доступа

1) Неавторизованный пользователь
    * Просмотр списка всех обращений/сообщений
2) Пользователь
    * Просмотр списка всех обращений/сообщений
    * Создание обращений
    * Изменение/удаление **своих** обращений
    * Ответ на сообщения поддержки в **своём обращении** (только один)
3) Поддержка
    * Просмотр списка всех обращений/сообщений
    * Создание ответа на обращение (только один)
    * Ответ на сообщения пользователя в **его обращении** (только один)
    * Изменять статус обращения пользователя
    * Удалить обращение пользователя
4) Администратор
    * Просмотр списка всех обращений/сообщений
    * Создание ответа на обращение (только один)
    * Ответ на сообщения пользователя в **его обращении** (только один)
    * Изменять статус обращения пользователя
    * Удалить/изменить обращение пользователя
    * Удалить/изменить сообщение пользователя
    * Удалить/изменить сообщение поддержки

## Подготовка и запуск проекта
#### Клонирование репозитория
Склонируйте репозиторий на локальную машину:
```bash
git clone https://github.com/Slavchick12/support.git
```
#### Подготовка базы данных PostgreSQL
##### Шаг 1. Скачайте и установите PostreSQL 14.5
```
https://www.enterprisedb.com/downloads/postgres-postgresql-downloads
```
##### Шаг 2. Запустите PostgreSQL и создайте БД supprot
#### Подготовка секретных переменных
##### Шаг 1. Перейдите в директорию с проектом
```bash
cd <path_to_project>/
```
##### Шаг 2. Создайте файл *.env*
##### Шаг 3. Заполните *.env* следующем образом
```
DB_ENGINE=django.db.backends.postgresql_psycopg2
DB_NAME=<DB_NAME>
POSTGRES_USER=<POSTGRES_USER>
POSTGRES_PASSWORD=<POSTGRES_PASSWORD>
DB_HOST=127.0.0.1
DB_PORT=5432
SECRET_KEY=<SECRET_KEY>
DEBUG=True
```
#### Настройка виртуального окружения и проведение миграций
##### Шаг 1. Установка виртуального окружения
```bash
cd <path_to_project/>
```
```bash
python -m venv venv
```
##### Шаг 2. Активация виртуального окружения
```bash
. venv/Scripts/activate
```
##### Шаг 3. Обновление пакетов pip
```bash
python -m pip install -U pip
```
##### Шаг 4. Установка зависимостей проекта
```bash
pip install -r requirements.txt
```
##### Шаг 6. Перейдите в директорию с файлом manage.py с запущенным виртуальным окружением
```bash
cd <path_to_project>/backend/
```
##### Шаг 7. Проведение миграции
```bash
python manage.py makemigrations
python manage.py migrate
```
#### Запуск проекта на локальной машине
```bash
python manage.py runserver
```
#### Создание суперюзера
```bash
python manage.py createsuperuser
```
#### Админ-панель Django
```bash
http://127.0.0.1:8000/admin
```
## JWT-авторизация
##### Шаг 1. Создание пользователя. Отправьте POST-запрос на адрес:
```
http://127.0.0.1:8000/auth/users/
```
##### Шаг 2. Получение токена авторизации. Отправьте POST-запрос на адрес и получите токен **access**:
```
http://127.0.0.1:8000/auth/jwt/create/
```
##### Шаг 3. Использование токена. При отправке запроса, вставьте полученный токен в параметр Authorization с ключом **Bearer**:
```
Authorization: Bearer <access-token>
```
## Используемый стек
```
Python, Django, DRF, PostgreSQL, Simple-JWT
```
#### Также используется
```
flake8, isort, django-filter, psycopg2-binary
```
